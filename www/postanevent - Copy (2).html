<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#2196f3">
  <meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap:">
  <title>Booked</title>
  <link rel="stylesheet" href="dist/css/framework7.min.css">
  <link rel="stylesheet" href="css/app.css">
  <link rel="apple-touch-icon" href="img/f7-icon-square.png">
  <link rel="icon" href="img/f7-icon.png">
  
</head>

<body class="color-theme-red">
  <div id="app">
    <div class="statusbar"></div>
    <div class="view view-main view-init ios-edges navbar-custom" data-url="/">
      <div class="page">
        <div class="navbar">
          <div class="navbar-inner sliding ">
            <div class="left header-section">
              <img src="img/booked_logo.jpg" class="navbar-logo">
              <div><b>Post Something To Do...</b></div>
            </div>
            <div class="right my-profile-navabar" onclick="goedit();">
              <a href="#">
                <img src="img/avatar.jpg" class="img-circle">
              <span>Edit</span>
              </a>
            </div>
          </div>
        </div>
        <div class="page-content hide-navbar-on-scroll white-bg pb-xlg edit-profile">
          <div class="block p-none">
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>Invite Description</b> </p>
              </div>
              <div class="grey-bg pl-lg pr-sm" style="background:#f2f2f2; padding:5px;">
                <div class="list inline-labels no-hairlines-md mt-sm mb-xs">
                  <div class="activity">
                      <label><span>Activity:</span> <input type="text" class="round" id="activity" onkeyup="autocomplet(this.id)"></label>
					  <div class="list links-list">
					  <ul id="activity_name"></ul>
					  </div>
                  </div>
                  <div class="clearfix"></div>
                  <div class="pl-lg mb-xs">
                    <p class="mt-xs lh-1"><small>It's best to be descriptive and include the neighborhood name.  (ie. Midtown, Buckhead, Virginia Highlands,  etc.)</small></p>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>Invite Type</b> </p>
              </div>
              <div class="grey-bg" style="background:#f2f2f2; padding:5px;">
                <div class="list mt-sm mb-xs">
                  <div class="radio-block flex-center">
                    <label class="f-18 mr-lg text-color-black">
                      <input id="invtype1" type="radio" name="invitetype" class="mr-xs" checked="checked" >Standard</label>
                    <label class="f-18 grey-text mr-sm">
                      <input id="invtype2" type="radio" name="invitetype" class="mr-xs">Personal (Coming Soon)</label>
                    <label class="f-18 grey-text mr-sm">
                      <input id="invtype3" type="radio" name="invitetype" class="mr-xs">Double Date (Coming Soon)</label>
                  </div>
                  <div class="pl-lg mb-xs">
                    <p class="mt-xs lh-1"><small>Your invites will not be visible to members on your Hidden List in Settings.  That includes all members that you have already met.</small></p>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>Decision Process</b> </p>
              </div>
              <div class="grey-bg" style="background:#f2f2f2; padding:5px;">
                <div class="list mt-sm mb-xs">
                  <div class="radio-block flex-center">
                    <label class="f-18 mr-lg text-color-black">
                      <input id="decision1" type="radio" name="decision" class="mr-xs">I decide</label>
                    <label class="f-18 grey-text mr-sm">
                      <input id="decision2" type="radio" name="decision" class="mr-xs">Instant Book (Coming Soon)</label>
                    <div class="row">
                      <div class="col-100 hours-text flex-center">
                        <span>I will decide by:</span>
                        <input id="decidevalue" type="tel" value="3"> <span>Hours Prior</span>
                      </div>
                    </div>
                  </div>
                  <div class="pl-lg mb-xs">
                    <p class="mt-xs lh-1"><small>Your invites will not be visible to members on your Hidden List in Settings.  That includes all members that you have already met.</small></p>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>Meeting Time</b> </p>
              </div>
              <div class="grey-bg" style="background:#f2f2f2; padding:5px;">
                <div class="list mt-sm mb-xs">
                  <div class="">
                    <label class="date-inline">
                      <span>Date:</span>
                      <input id="dt" type="tel" class="w-200" name="" id="eventdate">
                    </label>
                  </div>
                  <div class="">
                    <label class="date-inline">
                      <span>Time:</span>
                      <input id="ti" type="text"  id="demo-picker-custom-toolbar" />
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>Meeting Location</b> </p>
              </div>
              <div class="block mt-none pt-lg mb-none " style="background-color:#f0f0f0">
                <form>
                  <label class="search-location">
                    <input id="searchplace" type="text" class="round form-control" placeholder="Search for a place or address" name="" onkeyup="initService();">
                  </label>
				  <div class="list links-list">
					  <ul id="results"></ul>
				  </div>
                </form>
              </div>
              <div class="block mt-none mb-sm pb-lg" style="background-color:#f0f0f0">
                <!--<h2 class="text-center">Work</h2>-->
                <div class="row">
                  <div id="addresstext" class="col-50">

                  </div>
                  <div class="col-50">
                    <br>
                    <div id="map1" class="map"></div>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>Special Meeting Instructions</b> </p>
              </div>
              <div class="grey-bg" style="background:#f2f2f2; padding:5px;">
                <div class="list mt-sm mb-xs">
                  <div class="pl-sm pr-sm">
                    <textarea id="special" rows="3" placeholder="Meet by the ...."></textarea>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div class="block mb-xs">
                <p class="f-16 text-black"><b>My Chat Availability</b> </p>
              </div>
              <div class="grey-bg" style="background:#f2f2f2; padding:5px;">
                <div class="pl-lg mb-xs">
                  <p class="mt-xs lh-1"><small>Your Chat Availability will be visible if an applicant attempts to message you.</small></p>
                </div>
                <div class="list mt-sm mb-xs">
                  <div class="pl-sm pr-sm" id="chatstr">
				  
				  
				  <!--
                    <div class="f-14 mb-sm">
                      <label class="text-color-black">
                        <input type="radio" name="avail" class="mr-sm"> Busy day. I'm not available to chat, but look forward to meeting!</label>
                    </div>
                    <div class="f-14 mb-sm">
                      <label class="text-color-black">
                        <input type="radio" name="avail" class="mr-sm"> Busy day. I'll try my best to reply, but if I get caught up I look forward to meeting!</label>
                    </div>
                    <div class="f-14 mb-sm">
                      <label class="text-color-black">
                        <input type="radio" name="avail" class="mr-sm"> Leave Blank </label>
                    </div>
				  -->
				  
                  </div>
                </div>
              </div>
            </div>
            <a href="#" onclick="saveevents()" class="col button button-big button-fill button-block link external mt-lg">Post Invite</a>
            <br>
          </div>
        </div>
        <div class="toolbar tabbar-labels">
          <div class="toolbar-inner">
            <a href="#tab-1" class="tab-link tab-link-active"><i class="icon f7-icons ios-only">info_fill</i><span class="tabbar-label">Alerts</span></a>
            <a href="#tab-2" onclick="finddates();" class="tab-link"><i class="icon material-icons">my_location<span class="badge color-red">5</span></i><span class="tabbar-label">Find Dates</span></a>
            <a href="#tab-3" onclick="gosettings();" class="tab-link"><i class="icon f7-icons ios-only">alarm</i><span class="tabbar-label">My Schedule</span></a>
            <a href="#tab-4" onclick="gopostevent();" class="tab-link"><i class="icon material-icons ios-only">open_in_new</i><span class="tabbar-label">Post a Date</span></a>
            <a href="#tab-5" onclick="chat();" class="tab-link"><i class="icon material-icons ios-only">question_answer</i><span class="tabbar-label">Chat</span></a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="dist/js/framework7.min.js"></script>

<!--  <script type="text/javascript" src="jquery.inputmask.bundle.js"></script>-->
  <script src="js/routes.js"></script>
  <script src="js/app.js"></script>
    <script type="text/javascript" src="jquery-2.1.4.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>


<!--
 <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD2frSwSgh8f3PPbdItLAFKmdoemrW75l4&callback=initMap"
  type="text/javascript"></script>
 --> 
<script>
  function initMap() {
    var uluru = { lat: -25.363, lng: 131.044 };
    var map = new google.maps.Map(document.getElementById('map1'), {
      zoom: 4,
      center: uluru,

    });
    var marker = new google.maps.Marker({
      position: uluru,
      map: map,

    });
  }

</script>
<script type="text/javascript">
  
var memberid;
var eventname=0;
var placename;
var placeaddress;
var eventtime;
var whopays;
var chatavailability;
var visibility;
var decisiontype;
var timedecision;
var specialinstructions;
var locationwhencreated;

var lattitude=0;
var longitude=0;

var chartlength;
    // Wait for Cordova to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);
    // Cordova is ready
    //
    function onDeviceReady() {
        console.log("On Device Ready is Called...................");

        i_memberid = window.sessionStorage.getItem("memberid");
        i_PhoneNumber = window.sessionStorage.getItem("PhoneNumber");
        i_Gender = window.sessionStorage.getItem("Gender");
        i_SeekingGender = window.sessionStorage.getItem("SeekingGender");
        i_DOB = window.sessionStorage.getItem("DOB");

		memberid = i_memberid;
		
        loadchattypes();

    }  
  
  
  function finddates() {
    window.location.href = "search.html";
  }

  function chat() {
    window.location.href = "rsvp.html";
  }

  function goedit() {
    window.location.href = "edit-profile.html";
  }

  function gosettings() {
    window.location.href = "dashboard.html";
  }


  function logout() {
    window.location.href = "logout.html";
  }
  
	function gopostevent()
	{
		window.location.href = "postanevent.html";
	}   

/*
  jQuery(document).ready(function() {
    console.log("Page mounted");
    jQuery('#eventdate').inputmask("99/99/9999", {
      placeholder: "MM/DD/YYYY",

    });
  });
  var today = new Date();
  var pickerCustomToolbar = app.picker.create({
    inputEl: '#demo-picker-custom-toolbar',
    rotateEffect: true,
    renderToolbar: function() {
      return '<div class="toolbar">' +
        '<div class="toolbar-inner">' +
        '<div class="left">' +
        '<!-- <a href="#" class="link toolbar-randomize-link">Randomize</a> -->' +
        '</div>' +
        '<div class="right">' +
        '<a href="#" class="link sheet-close popover-close">Close</a>' +
        '</div>' +
        '</div>' +
        '</div>';
    },

    formatValue: function(values) {
      return values[0] + ' : ' + values[1] + '  ' + values[2];
    },
    cols: [{
        values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
      },
      // Divider
      {
        divider: true,
        content: ':'
      },
      {
        values: (function() {
          var arr = [];
          for (var i = 0; i <= 59; i++) { arr.push(i < 10 ? '0' + i : i); }
          return arr;
        })(),
      },
      {
        values: ('am pm').split(' ')
      },
    ],
    on: {
      open: function(picker) {
        picker.$el.find('.toolbar-randomize-link').on('click', function() {
          var col0Values = picker.cols[0].values;
          var col0Random = col0Values[Math.floor(Math.random() * col0Values.length)];

          var col3Values = picker.cols[3].values;
          var col3Random = col3Values[Math.floor(Math.random() * col3Values.length)];

          var col2Values = picker.cols[2].values;
          var col2Random = col2Values[Math.floor(Math.random() * col2Values.length)];

          picker.setValue([col0Random, col2Random, col3Random]);
        });
      },
    }
  });
*/


function loadchattypes()
{
    $.ajax({
      url: "http://18.219.77.161/api/loadchattypes.php",
      type: "POST",
      dataType: "JSON",
      success: function(jsonStr) {

        var jsonstr = JSON.stringify(jsonStr);

        var jsonobject = JSON.parse(jsonstr);

        var result;

        for (i = 1; i < jsonobject.length; i++) {
          result = jsonobject[i].result;
        }

        if (result == "FAIL") {

        } 
		else 
		{

		  var msgstr="";
		  
		  chartlength = jsonobject.length;
		  
          for (i = 1; i < jsonobject.length; i++) 
		  {
              var Chat_ID = jsonobject[i].ID;
              var Chat_Desc = jsonobject[i].Description;

			  if (i == 1)
			  {
			  msgstr=msgstr+'<div class="f-14 mb-sm"><label class="text-color-black"><input type="radio" name="chattype" id="chatid' + i + '" class="mr-sm" value="' + Chat_ID + '" checked="checked">' + Chat_Desc + '</label></div>';
			  }
			  else
			  {
			  msgstr=msgstr+'<div class="f-14 mb-sm"><label class="text-color-black"><input type="radio" name="chattype" id="chatid' + i + '" class="mr-sm" value="' + Chat_ID + '">' + Chat_Desc + '</label></div>';			  
			  }
			  
          }
		  
		  document.getElementById("chatstr").innerHTML = msgstr;
		  
        }
      },
      error: function(requestObject, error, errorThrown) {
        alert(error);
        alert(errorThrown);
      }
    });
}  


var currentrowid = 0;

function autocomplet(clicked_id) {
	
	var min_length = 0; // min caracters to display the autocomplete
	
	currentrowid = clicked_id;
	
	var key = '#' + currentrowid;
		
	var keyword = $(key).val();
	

	if (keyword.length >= min_length) {
		$.ajax({
			url: 'http://18.219.77.161/api/ajax_activity.php',
			type: 'POST',
			data: {keyword:keyword},
			success:function(data){
				$('#activity_name').show();
				$('#activity_name').html(data);
			}
		});
	} else {
		$('#activity_name').hide();
	}
}


// set_item : this function will be executed when we select an item
function set_coordinates(p_id, p_eventname, p_searchtags) 
{
	//alert(id + " - " + eventname + " - " + searchtags);
	
	$('#activity_name').hide();
	
	document.getElementById("activity").value = p_eventname;
	eventname = p_id;
}


function saveevents()
{

		if (document.getElementById('invtype1').checked) {
			visibility = "Standard";
		}
		else if (document.getElementById('invtype2').checked) {
			visibility = "Personal";
		}
		else if (document.getElementById('invtype3').checked) {
			visibility = "Double Date";
		}		
		
		
		
		if (document.getElementById('decision1').checked) {
			decisiontype  = "I decide"; 
		}
		else if (document.getElementById('decision2').checked) {
			decisiontype = "Instant Book";
		}
		
		timedecision = document.getElementById('decidevalue').value;
		
		eventtime = document.getElementById('dt').value + " " + document.getElementById('ti').value;
		
		//placename = "Pizza";
		//placeaddress = "Pizza Hut, ABC Street";
		
		specialinstructions = document.getElementById('special').value;
		
		console.log(specialinstructions);
		
		for (i=1; i < chartlength; i++)
		{
			temp_chatid = "chatid" + i;
			
			if (document.getElementById(temp_chatid).checked) 
			{
				chatavailability = document.getElementById(temp_chatid).value;
				console.log(chatavailability);
			}
		}
		
		
		whopays = "";
		locationwhencreated = "";
		 
        $.ajax({
            url: "http://18.219.77.161/api/saveevents.php",
            type: "POST",
            dataType: "JSON",
            data: '{"memberid":"' + memberid + '","eventname":"' + eventname + '","placename":"' + placename + '","placeaddress":"' + placeaddress + '","eventtime":"' + eventtime + '","whopays":"' + whopays + '","chatavailability":"' + chatavailability + '","visibility":"' + visibility + '","decisiontype":"' + decisiontype + '","timedecision":"' + timedecision + '","specialinstructions":"' + specialinstructions + '","locationwhencreated":"' + locationwhencreated + '"}',
            success: function(jsonStr) {

                var jsonstr = JSON.stringify(jsonStr);

                var jsonobject = JSON.parse(jsonstr);


                var result;

                for (i = 1; i < jsonobject.length; i++) {
                    result = jsonobject[i].result;
                }

                if (result == "FAIL") 
				{
					app.dialog.alert('<br>Event not created!');
					
                } 
				else 
				{

					app.dialog.alert('<br>Event has been created!');

                }

            },
            error: function(requestObject, error, errorThrown) {
                alert(error);
                alert(errorThrown);
            }
        });


}

      function initService() {
        var displaySuggestions = function(predictions, status) {
          if (status != google.maps.places.PlacesServiceStatus.OK) {
            alert(status);
            return;
          }


		  var placsnodes="";
          predictions.forEach(function(prediction) {
		  /*
            var li = document.createElement('li');
            li.appendChild(document.createTextNode(prediction.description));
            document.getElementById('results').appendChild(li);*/
			
		  placsnodes=placsnodes + '<li data-value="' + prediction.description + '"><a href="#">' + prediction.description + '</a></li>';			
          });
			
			//alert(placsnodes);
			$('#results').show();
			$('#results').html(placsnodes);
				
        };

		var searchplace = document.getElementById("searchplace").value;
		
		if (searchplace == "")
		{
		
		}
		else
		{
			var service = new google.maps.places.AutocompleteService();
			service.getQueryPredictions({ input: searchplace }, displaySuggestions);
		}


}
	  
$("#results").on("click", "a", function(e){
    e.preventDefault();
    var $this = $(this).parent();
    $this.addClass("select").siblings().removeClass("select");
	
    var address = $this.data("value");
	
	document.getElementById("addresstext").innerHTML = "<br>" + address;
	$('#results').hide();
	
		placename = address;
		placeaddress = address;

            var geocoder =  new google.maps.Geocoder();
    geocoder.geocode( { 'address': address}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            //alert("location : " + results[0].geometry.location.lat() + " " +results[0].geometry.location.lng()); 
			
			lattitude = results[0].geometry.location.lat();
			longitude = results[0].geometry.location.lng();
	//alert(lattitude + "  " + longitude);

    var uluru = { lat: lattitude, lng: longitude };
    var map = new google.maps.Map(document.getElementById('map1'), {
      zoom: 4,
      center: uluru,

    });
    var marker = new google.maps.Marker({
      position: uluru,
      map: map,
    });	



	
		  } else {
            //alert("Something got wrong " + status);
          }
        });
	

	

})
			
</script>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD2frSwSgh8f3PPbdItLAFKmdoemrW75l4&libraries=places"
        async defer></script>
		
</body>

</html>
